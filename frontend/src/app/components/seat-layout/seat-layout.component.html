<div class="seat-layout-container">
  <button class="back-btn" (click)="onBackClick()">← Back</button>

  <div class="booking-header" *ngIf="selectedMovie && selectedShow">
    <div class="movie-info">
      <h2 class="movie-title">{{ selectedMovie.title }}</h2>
      <span class="movie-language">{{ selectedMovie.language }}</span>
    </div>
    <div class="show-info">{{ formatDateTime(selectedShow.showTime) }}</div>
  </div>

  <!-- Language Selection -->
  <div class="language-selection">
    <label for="language-select" class="language-label">Select Language:</label>
    <select 
      id="language-select" 
      class="language-dropdown"
      [value]="selectedLanguage"
      (change)="onLanguageChange($event)">
      <option *ngFor="let lang of availableLanguages" [value]="lang">{{ lang }}</option>
    </select>
  </div>

  <div *ngIf="bookingMessage && !bookingSuccess" 
       class="booking-message error">
    {{ bookingMessage }}
  </div>

  <!-- Success Modal -->
  <div class="success-modal-overlay" *ngIf="bookingSuccess && bookingMessage" (click)="closeSuccessModal()">
    <div class="success-modal" (click)="$event.stopPropagation()">
      <button class="modal-close-x" (click)="closeSuccessModal()">×</button>
      <div class="success-icon">✓</div>
      <h3 class="success-title">Booking Confirmed!</h3>
      <div class="success-details">
        <p class="success-movie">{{ selectedMovie?.title }}</p>
        <p class="success-info">{{ selectedLanguage }} • {{ formatDateTime(selectedShow?.showTime || '') }}</p>
        <p class="success-seat">Seat: <strong>{{ bookedSeatNumber || 'Confirmed' }}</strong></p>
      </div>
      <p class="success-message">Enjoy your movie!</p>
      <button class="success-close-btn" (click)="closeSuccessModal()">Continue Booking</button>
    </div>
  </div>

  <div *ngIf="loading" class="loading">
    <div class="spinner"></div>
    <p>Loading...</p>
  </div>

  <div *ngIf="!loading && seatRows.length > 0" class="seat-section">
    <div class="screen-container">
      <div class="screen"></div>
      <span class="screen-label">Screen</span>
    </div>

    <div class="seats-grid">
      <div *ngFor="let seatRow of seatRows" class="seat-row">
        <span class="row-label">{{ seatRow.row }}</span>
        <ng-container *ngFor="let seat of seatRow.seats">
          <button 
            [class]="getSeatClass(seat)"
            [disabled]="!isSeatClickable(seat)"
            (click)="onSeatClick(seat)">
            {{ getSeatDisplayNumber(seat) }}
          </button>
        </ng-container>
      </div>
    </div>

    <div class="seat-legend">
      <div class="legend-item">
        <div class="legend-seat available"></div>
        <span>Available</span>
      </div>
      <div class="legend-item">
        <div class="legend-seat selected"></div>
        <span>Selected</span>
      </div>
      <div class="legend-item">
        <div class="legend-seat booked"></div>
        <span>Booked</span>
      </div>
    </div>
  </div>

  <div *ngIf="!loading && seatRows.length === 0" class="no-seats">
    <p>No seats available</p>
  </div>
</div>
